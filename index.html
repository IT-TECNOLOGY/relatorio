<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Relat√≥rio de Est√°gio</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
      }

      .form-section {
        display: flex;
        justify-content: center;
        background: #c5ffc5;
        padding: 20px;
      }

      .form-section h1,
      .form-section h3 {
        text-align: center;
      }

      .form-section input {
        width: 80%;
        margin: 5px;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 5px;
      }

      .print-page {
        width: 210mm;
        height: 297mm;
        margin: 10px auto;
        padding: 20px;
        border: 1px solid #ddd;
        background: white;
        page-break-after: always;
      }

      @media print {
        .form-section,
        .print-button {
          display: none;
        }

        .print-page {
          margin: 0;
          border: none;
          page-break-after: always;
        }
      }

      td {
        padding: 5px;
        border: 1px solid;
        width: 57px;
        height: 25px;
      }

      p {
        margin-bottom: 13px;
      }

      .cabecalho p {
        margin-bottom: -4px;
      }

      #reports-container {
        display: none;
      }

      .download-card {
        background: white;
        border-radius: 16px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        padding: 40px;
        text-align: center;
        max-width: 500px;
        width: 100%;
        transition: transform 0.3s ease;
      }

      .download-card:hover {
        transform: translateY(-5px);
      }

      .file-icon {
        font-size: 64px;
        color: #4a6ee0;
        margin-bottom: 20px;
      }

      h1 {
        color: #333;
        margin-bottom: 10px;
        font-size: 24px;
      }

      .description {
        color: #666;
        margin-bottom: 30px;
        line-height: 1.6;
      }

      .file-details {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 25px;
        text-align: left;
      }

      .file-details p {
        margin: 8px 0;
        color: #555;
        display: flex;
        justify-content: space-between;
      }

      .file-details span {
        font-weight: 600;
        color: #333;
      }

      .download-card {
        background: white;
        border-radius: 16px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        padding: 40px;
        text-align: center;
        max-width: 500px;
        width: 100%;
        transition: transform 0.3s ease;
      }

      .download-card:hover {
        transform: translateY(-5px);
      }

      .file-icon {
        font-size: 64px;
        color: #4a6ee0;
        margin-bottom: 20px;
      }

      h1 {
        color: #333;
        margin-bottom: 10px;
        font-size: 24px;
      }

      .description {
        color: #666;
        margin-bottom: 30px;
        line-height: 1.6;
      }

      .file-details {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 25px;
        text-align: left;
      }

      .file-details p {
        margin: 8px 0;
        color: #555;
        display: flex;
        justify-content: space-between;
      }

      .file-details span {
        font-weight: 600;
        color: #333;
      }

      .download-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #4a6ee0, #6a11cb);
        color: white;
        border: none;
        padding: 16px 32px;
        font-size: 18px;
        font-weight: 600;
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(106, 17, 203, 0.4);
        position: relative;
        overflow: hidden;
        width: 100%;
      }

      .download-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(106, 17, 203, 0.5);
      }

      .download-btn:active {
        transform: translateY(1px);
      }

      .download-btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: all 0.6s ease;
      }

      .download-btn:hover::before {
        left: 100%;
      }

      .download-icon {
        margin-right: 12px;
        font-size: 20px;
        transition: transform 0.3s ease;
      }

      .download-btn:hover .download-icon {
        animation: bounce 0.5s ease infinite alternate;
      }

      @keyframes bounce {
        from {
          transform: translateY(0);
        }
        to {
          transform: translateY(-5px);
        }
      }

      .success-message {
        margin-top: 15px;
        color: #28a745;
        font-weight: 600;
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .success-message.show {
        opacity: 1;
      }

      @media (max-width: 480px) {
        .download-card {
          padding: 25px;
        }

        h1 {
          font-size: 20px;
        }

        .download-btn {
          padding: 14px 24px;
          font-size: 16px;
        }
      }
    </style>
  </head>
  <body>
    <section class="form-section">
      <div class="download-card">
        <div class="file-icon">üìä</div>
        <h1>Modelo de Visitas</h1>

        <div class="file-details">
          <p>Nome do arquivo: <span>VISITAS - MODELO.xlsx</span></p>
          <p>Tipo: <span>Planilha Excel</span></p>
        </div>

        <button class="download-btn" id="downloadBtn">
          <span class="download-icon">‚¨áÔ∏è</span>
          BAIXAR MODELO
        </button>

        <div class="success-message" id="successMessage">
          Download iniciado com sucesso!
        </div>
      </div>

      <script>
        document
          .getElementById("downloadBtn")
          .addEventListener("click", function () {
            // Criar um elemento <a> tempor√°rio para o download
            const link = document.createElement("a");

            // Usar o arquivo que est√° na pasta do projeto
            link.href = "./VISITAS - MODELO.xlsx"; // Arquivo atual na pasta do projeto
            link.download = "VISITAS - MODELO.xlsx"; // Nome correto para download

            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            // Efeito visual de confirma√ß√£o
            const btn = this;
            const originalText = btn.innerHTML;
            const successMessage = document.getElementById("successMessage");

            btn.innerHTML =
              '<span class="download-icon">‚úì</span> DOWNLOAD INICIADO';
            btn.style.background = "linear-gradient(135deg, #28a745, #20c997)";
            successMessage.classList.add("show");

            setTimeout(() => {
              btn.innerHTML = originalText;
              btn.style.background =
                "linear-gradient(135deg, #4a6ee0, #6a11cb)";
              successMessage.classList.remove("show");
            }, 3000);
          });
      </script>

      <div class="container">
        <h1>Informa√ß√µes dos Alunos para o Relat√≥rio</h1>
        <div style="display: none">
          <div class="mb-3">
            <h3>Nome do Estagi√°rio</h3>
            <input
              id="nome"
              type="text"
              class="form-control"
              placeholder="Digite o nome"
            />
          </div>
          <div class="mb-3">
            <h3>Matr√≠cula</h3>
            <input
              id="matricula"
              type="text"
              class="form-control"
              placeholder="Digite a matr√≠cula"
            />
          </div>
          <div class="mb-3">
            <h3>Curso</h3>
            <input
              id="curso"
              type="text"
              class="form-control"
              placeholder="Digite o curso"
            />
          </div>
          <div class="mb-3">
            <h3>Orientador de Est√°gio (IES)</h3>
            <input
              id="orientador"
              type="text"
              class="form-control"
              placeholder="Digite o nome do orientador"
            />
          </div>
          <div class="mb-3">
            <h3>Empresa Concedente de Est√°gio</h3>
            <input
              id="empresa"
              type="text"
              class="form-control"
              placeholder="Digite o nome da empresa"
            />
          </div>
          <div class="mb-3">
            <h3>Supervisor da Empresa</h3>
            <input
              id="supervisor"
              type="text"
              class="form-control"
              placeholder="Digite o nome do supervisor"
            />
          </div>
          <div class="mb-3">
            <h3>Hor√°rio de Est√°gio</h3>
            <input
              id="horario"
              type="text"
              class="form-control"
              placeholder="Digite o hor√°rio de est√°gio"
            />
          </div>
          <button
            onclick="generateFromForm()"
            class="btn btn-primary print-button"
          >
            Gerar Relat√≥rio do Formul√°rio
          </button>
          <button onclick="clearReports()" class="btn btn-danger print-button">
            Limpar Relat√≥rios
          </button>
          <!-- fim da div oculta -->
        </div>

        <div class="mb-3">
          <h3>Importar Dados de Excel</h3>
          <input
            type="file"
            id="excel-file"
            accept=".xlsx, .xls"
            class="form-control"
          />
        </div>

        <div class="text-center mb-5">
          <button onclick="window.print()" class="btn btn-success print-button">
            Imprimir Relat√≥rios
          </button>
        </div>
      </div>
    </section>

    <div id="reports-container"></div>

    <script>
      // Template para a p√°gina 1 do relat√≥rio
      const page1Template = (index) => `
            <div class="print-page" id="page1-${index}">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <img src="./logo-facape.png" width="80px" height="80px" alt="Logo FACAPE" />
                    <div style="text-align: center">
                        <h6 style="font-weight: bold">
                            AUTARQUIA EDUCACIONAL DO VALE DO S√ÉO FRANCISCO ‚Äì AEVSF FACULDADE DE
                            PETROLINA ‚Äì FACAPE
                            <br />
                            EST√ÅGIO/BOLSA
                        </h6>
                        <p style="font-size: smaller">
                            Campus Universit√°rio, s/n ‚Äì Vila Eduardo ‚Äì Petrolina/PE. CEP:
                            56328-903. <br />
                            Fone: 87-3866-3200, 3866-3213
                        </p>
                    </div>
                    <img src="./prefeitura de petrolina.png" width="80px" height="80px" alt="Logo Prefeitura" />
                </div>
                <div style="font-size: small; margin-left: 35px; margin-right: 35px">
                    <p style="text-align: center">
                        <b> RELAT√ìRIO DE ACOMPANHAMENTO DE EST√ÅGIO </b>
                    </p>
                    <div class="cabecalho">
                        <p>
                            <b>NOME DO ESTAGI√ÅRIO:</b> <span id="nome1-${index}"></span>&nbsp;<b>MATR√çCULA:</b>
                            <span id="matricula1-${index}"></span>
                        </p>
                        <p>
                            <b>CURSO:</b> <span id="curso1-${index}"></span>&nbsp;<b>ORIENTADOR DE EST√ÅGIO (IES):</b>
                            <span id="orientador1-${index}"></span>
                        </p>
                        <p>
                            <b>Empresa Concedente de Est√°gio:</b> <span id="empresa1-${index}"></span>
                        </p>
                        <p>
                            <b>Supervisor da Empresa:</b> <span id="supervisor1-${index}"></span>
                            <b>Hor√°rio de Est√°gio:</b> <span id="horario1-${index}"></span>
                        </p>
                    </div>
                    <br />
                    <b>A SER PREENCHIDO PELO SUPERVISOR DA EMPRESA</b>
                    <br />
                    <p>
                        <b>1.Como voc√™ avalia o desempenho do estagi√°rio nos seguintes aspectos comportamentais:</b>
                    </p>
                    <p>
                        <b>1.1.Facilidade de compreens√£o (rapidez e facilidade de interpretar e p√¥r em pr√°tica ou atender instru√ß√µes e informa√ß√µes)</b>
                    </p>
                    <table>
                        <tr>
                            <td><b>√ìtimo</b></td>
                            <td></td>
                            <td><b>Bom</b></td>
                            <td></td>
                            <td><b>Regular</b></td>
                            <td></td>
                            <td><b>Ruim</b></td>
                            <td></td>
                        </tr>
                    </table>
                    <p><b>1.2.Assiduidade (frequ√™ncia de est√°gio)</b></p>
                    <table>
                        <tr>
                            <td><b>√ìtimo</b></td>
                            <td></td>
                            <td><b>Bom</b></td>
                            <td></td>
                            <td><b>Regular</b></td>
                            <td></td>
                            <td><b>Ruim</b></td>
                            <td></td>
                        </tr>
                    </table>
                    <p><b>1.3.Pontualidade (cumprimento do hor√°rio da organiza√ß√£o)</b></p>
                    <table>
                        <tr>
                            <td><b>√ìtimo</b></td>
                            <td></td>
                            <td><b>Bom</b></td>
                            <td></td>
                            <td><b>Regular</b></td>
                            <td></td>
                            <td><b>Ruim</b></td>
                            <td></td>
                        </tr>
                    </table>
                    <p><b>1.3.Pontualidade (cumprimento do hor√°rio da organiza√ß√£o)</b></p>
                    <table>
                        <tr>
                            <td><b>√ìtimo</b></td>
                            <td></td>
                            <td><b>Bom</b></td>
                            <td></td>
                            <td><b>Regular</b></td>
                            <td></td>
                            <td><b>Ruim</b></td>
                            <td></td>
                        </tr>
                    </table>
                    <p>
                        <b>1.4.Coopera√ß√£o(disposi√ß√£o para ajudar e/ou cooperar com os colegas)</b>
                    </p>
                    <table>
                        <tr>
                            <td><b>√ìtimo</b></td>
                            <td></td>
                            <td><b>Bom</b></td>
                            <td></td>
                            <td><b>Regular</b></td>
                            <td></td>
                            <td><b>Ruim</b></td>
                            <td></td>
                        </tr>
                    </table>
                    <p>
                        <b>2.Como voc√™ avalia o desempenho do est√°gio na execu√ß√£o das atividades de est√°gio?</b>
                    </p>
                    <table>
                        <tr>
                            <td><b>√ìtimo</b></td>
                            <td></td>
                            <td><b>Bom</b></td>
                            <td></td>
                            <td><b>Regular</b></td>
                            <td></td>
                            <td><b>Ruim</b></td>
                            <td></td>
                        </tr>
                    </table>
                    <p>
                        <b>3.O est√°gio em condi√ß√£o de desenvolver outras atividades mais complexas?</b>
                    </p>
                    <table>
                        <tr>
                            <td><b>√ìtimo</b></td>
                            <td></td>
                            <td><b>Bom</b></td>
                            <td></td>
                            <td><b>Regular</b></td>
                            <td></td>
                            <td><b>Ruim</b></td>
                            <td></td>
                        </tr>
                    </table>
                    <p>
                        <b>Voc√™ deseja incluir novas atividades para o est√°gio ,atrav√©s da confec√ß√£o de um Termo aditivo ao Contrato, promovendo a progressividade do est√°gio, para atender a Lei n¬∞.11.788/08, no par√°grafo √∫nico do Art.7¬∞?</b>
                    </p>
                    <table>
                        <tr>
                            <td><b>Sim</b></td>
                            <td></td>
                            <td><b>N√£o</b></td>
                            <td></td>
                        </tr>
                    </table>
                    <br />
                    <p><b>Quais?</b></p>
                    <div style="border-bottom: 1px solid"></div>
                    <div style="border-bottom: 1px solid; margin-top: 23px"></div>
                    <b>DATA: ___/___/_____</b>
                    <br /><br /><br />
                    <div style="display: flex; justify-content: space-around">
                        <div style="border-bottom: 1px solid; width: 250px"></div>
                        <div style="border-bottom: 1px solid; width: 250px"></div>
                    </div>
                    <div style="display: flex; justify-content: space-around">
                        <div style="width: 147px">Assinatura do orientador</div>
                        <div style="width: 147px">Assinatura do supervisor</div>
                    </div>
                </div>
            </div>
        `;

      // Template para a p√°gina 2 do relat√≥rio
      const page2Template = (index) => `
            <div class="print-page" id="page2-${index}">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <img src="./logo-facape.png" width="80px" height="80px" alt="Logo FACAPE" />
                    <div style="text-align: center">
                        <h6 style="font-weight: bold">
                            AUTARQUIA EDUCACIONAL DO VALE DO S√ÉO FRANCISCO ‚Äì AEVSF FACULDADE DE
                            PETROLINA ‚Äì FACAPE
                            <br />
                            EST√ÅGIO/BOLSA
                        </h6>
                        <p style="font-size: smaller">
                            Campus Universit√°rio, s/n ‚Äì Vila Eduardo ‚Äì Petrolina/PE. CEP:
                            56328-903. <br />
                            Fone: 87-3866-3200, 3866-3213
                        </p>
                    </div>
                    <img src="./prefeitura de petrolina.png" width="80px" height="80px" alt="Logo Prefeitura" />
                </div>
                <div style="font-size: small; margin-left: 35px; margin-right: 35px">
                    <div class="cabecalho">
                        <p style="text-align: center">
                            <b> RELAT√ìRIO DE ACOMPANHAMENTO DE EST√ÅGIO </b>
                        </p>
                        <br />
                        <p>
                            <b>NOME DO ESTAGI√ÅRIO:</b> <span id="nome2-${index}"></span>&nbsp;<b>MATR√çCULA:</b>
                            <span id="matricula2-${index}"></span>
                        </p>
                        <p>
                            <b>CURSO:</b> <span id="curso2-${index}"></span>&nbsp;<b>Orientador de Est√°gio (IES):</b>
                            <span id="orientador2-${index}"></span>
                        </p>
                        <p>
                            <b>Empresa Concedente de Est√°gio:</b> <span id="empresa2-${index}"></span>
                        </p>
                        <p>
                            <b>Supervisor da Empresa:</b> <span id="supervisor2-${index}"></span>
                            <b>Hor√°rio de Est√°gio:</b> <span id="horario2-${index}"></span>
                        </p>
                    </div>
                    <br />
                    <p>
                        <b>1.Descreva as principais atividades desenvolvidas no est√°gio:</b>
                    </p>
                    <div style="border-bottom: 1px solid"></div>
                    <div style="border-bottom: 1px solid; margin-top: 23px"></div>
                    <p>
                        <b>2.O est√°gio tem proporcionado aquisi√ß√£o de novos conhecimentos e experi√™ncias pr√°ticas importantes para sua forma√ß√£o? Quais?</b>
                    </p>
                    <div style="border-bottom: 1px solid"></div>
                    <div style="border-bottom: 1px solid; margin-top: 23px"></div>
                    <p>
                        <b>3.O ambiente de est√°gio √© adequado para o desenvolvimento de suas atividades ? Quais as dificuldades que voc√™ encontra no seu est√°gio ?</b>
                    </p>
                    <div style="border-bottom: 1px solid"></div>
                    <div style="border-bottom: 1px solid; margin-top: 23px"></div>
                    <p>
                        <b>4.Como voc√™ descreveria a influ√™ncia do est√°gio na sua vida profissional e pessoal? ?</b>
                    </p>
                    <div style="border-bottom: 1px solid"></div>
                    <div style="border-bottom: 1px solid; margin-top: 23px"></div>
                    <p>
                        <b>5.Como o est√°gio est√° contribuindo para um melhor aproveitamento escolar? (pode escolher mais de uma op√ß√£o).</b>
                    </p>
                    <p>
                        5.1.Cultivo bons relacionamentos com os colegas, professores e dirigentes. ( )
                    </p>
                    <p>
                        5.2.Desenvolvi o h√°bito pela pesquisa e leitura de assuntos diversos, inclusive de temas escolares. ( )
                    </p>
                    <p>
                        5.3.Compreendo com mais facilidade os conte√∫dos abordados em sala de aula. ( )
                    </p>
                    <p>
                        <b>6.O supervisor de est√°gio acompanha e esclarece d√∫vidas para que voc√™ exer√ßa da melhor forma poss√≠vel as atividades descritas no seu termo de compromisso de est√°gio? Como ele lhe auxilia nas suas atividades?</b>
                    </p>
                    <div style="border-bottom: 1px solid"></div>
                    <div style="border-bottom: 1px solid; margin-top: 23px"></div>
                    <p>
                        <b>7.Como voc√™ se classifica atuando na empresa ? Classifique cada quesito usando os indicadores de (1) para Baixa, (2) para regular e (3) para Alta.</b>
                    </p>
                    <table>
                        <tr>
                            <td style="width: 250px">Assiduidade</td>
                            <td style="width: 150px"></td>
                            <td style="width: 250px">Pontualidade</td>
                            <td style="width: 150px"></td>
                            <td style="width: 250px">Interesse</td>
                            <td style="width: 150px"></td>
                            <td style="width: 250px">Iniciativa</td>
                            <td style="width: 150px"></td>
                        </tr>
                        <tr>
                            <td style="width: 250px">Relacionamento</td>
                            <td style="width: 150px"></td>
                            <td style="width: 250px">Conhecimento</td>
                            <td style="width: 150px"></td>
                            <td style="width: 250px">Efici√™ncia</td>
                            <td style="width: 150px"></td>
                        </tr>
                    </table>
                    <p style="margin-bottom: 24px">
                        <b>ESPA√áO RESERVADO PARA INFORMA√á√ïES ADICIONAIS:</b>
                    </p>
                    <div style="border-bottom: 1px solid"></div>
                    <b>DATA: ___/___/_____</b>
                    <br /><br /><br />
                    <div style="display: flex; justify-content: space-around">
                        <div style="border-bottom: 1px solid; width: 250px"></div>
                        <div style="border-bottom: 1px solid; width: 250px"></div>
                    </div>
                    <div style="display: flex; justify-content: space-around">
                        <div style="width: 147px">Assinatura do orientador</div>
                        <div style="width: 147px">Assinatura do supervisor</div>
                    </div>
                </div>
            </div>
        `;

      // Fun√ß√£o para gerar relat√≥rio a partir do formul√°rio
      function generateFromForm() {
        const reportsContainer = document.getElementById("reports-container");
        reportsContainer.style.display = "block";

        // Limpa relat√≥rios anteriores
        reportsContainer.innerHTML = "";

        // Adiciona as p√°ginas do relat√≥rio
        const index = 0;
        reportsContainer.innerHTML += page1Template(index);
        reportsContainer.innerHTML += page2Template(index);

        // Preenche os dados do formul√°rio
        const fields = [
          "nome",
          "matricula",
          "curso",
          "orientador",
          "empresa",
          "supervisor",
          "horario",
        ];
        fields.forEach((field) => {
          const value = document.getElementById(field).value;
          console.log(`Campo ${field} - Valor: ${value}`); // DEBUG
          const span1 = document.getElementById(`${field}1-${index}`);
          const span2 = document.getElementById(`${field}2-${index}`);
          if (span1 && span2) {
            span1.textContent = value;
            span2.textContent = value;
            console.log(`Preenchido ${field} nas p√°ginas 1 e 2.`); // DEBUG
          } else {
            console.warn(
              `Elemento ${field}1-${index} ou ${field}2-${index} n√£o encontrado.`
            ); // DEBUG
          }
        });
      }

      // Fun√ß√£o para limpar todos os relat√≥rios
      function clearReports() {
        document.getElementById("reports-container").innerHTML = "";
        document.getElementById("reports-container").style.display = "none";
      }

      document
        .getElementById("excel-file")
        .addEventListener("change", (event) => {
          const file = event.target.files[0];
          const reader = new FileReader();

          reader.onload = (e) => {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, { type: "array" });

            // Encontra a aba correta (CURSO - ORIENTADOR)
            const sheetName =
              workbook.SheetNames.find(
                (name) =>
                  name.toLowerCase().includes("curso") &&
                  name.toLowerCase().includes("orientador")
              ) || workbook.SheetNames[0];

            const sheet = workbook.Sheets[sheetName];
            const jsonData = XLSX.utils.sheet_to_json(sheet, {
              header: [
                "MATR√çCULA",
                "NOME",
                "CURSO",
                "HOR√ÅRIO",
                "EMPRESA",
                "SETOR",
                "VIG√äNCIA",
                "SUPERVISOR",
                "ORIENTADOR",
                "ENDERE√áO",
                "CIDADE",
                "TELEFONE",
              ],
              range: 1, // Pula a linha de cabe√ßalho
            });

            // Ordenar os dados por nome em ordem alfab√©tica
            jsonData.sort((a, b) => {
              const nomeA = (a.NOME || "").toUpperCase();
              const nomeB = (b.NOME || "").toUpperCase();
              if (nomeA < nomeB) return -1;
              if (nomeA > nomeB) return 1;
              return 0;
            });

            const reportsContainer =
              document.getElementById("reports-container");
            reportsContainer.style.display = "block";
            reportsContainer.innerHTML = "";

            jsonData.forEach((row, index) => {
              // Verifica se a linha tem dados v√°lidos
              if (!row.NOME || row.NOME.trim() === "") return;

              reportsContainer.innerHTML += page1Template(index);
              reportsContainer.innerHTML += page2Template(index);

              // Preenche os dados do Excel com os nomes de colunas corretos
              document.getElementById(`nome1-${index}`).textContent =
                row.NOME || "";
              document.getElementById(`nome2-${index}`).textContent =
                row.NOME || "";
              document.getElementById(`matricula1-${index}`).textContent =
                row["MATR√çCULA"] || "";
              document.getElementById(`matricula2-${index}`).textContent =
                row["MATR√çCULA"] || "";
              document.getElementById(`curso1-${index}`).textContent =
                row.CURSO || "";
              document.getElementById(`curso2-${index}`).textContent =
                row.CURSO || "";
              document.getElementById(`orientador1-${index}`).textContent =
                row.ORIENTADOR || "";
              document.getElementById(`orientador2-${index}`).textContent =
                row.ORIENTADOR || "";
              document.getElementById(`empresa1-${index}`).textContent =
                row.EMPRESA || "";
              document.getElementById(`empresa2-${index}`).textContent =
                row.EMPRESA || "";
              document.getElementById(`supervisor1-${index}`).textContent =
                row.SUPERVISOR || "";
              document.getElementById(`supervisor2-${index}`).textContent =
                row.SUPERVISOR || "";
              document.getElementById(`horario1-${index}`).textContent =
                row.HOR√ÅRIO || "";
              document.getElementById(`horario2-${index}`).textContent =
                row.HOR√ÅRIO || "";
            });
          };

          reader.readAsArrayBuffer(file);
        });

      // Atualizar campos ao digitar (para o formul√°rio manual)
      const updateField = (inputId, spanId) => {
        document.getElementById(inputId).addEventListener("input", function () {
          document.getElementById(spanId).textContent = this.value;
        });
      };

      // Configura os listeners para o formul√°rio manual
      document.addEventListener("DOMContentLoaded", () => {
        updateField("nome", "nome1-0");
        updateField("nome", "nome2-0");
        updateField("matricula", "matricula1-0");
        updateField("matricula", "matricula2-0");
        updateField("curso", "curso1-0");
        updateField("curso", "curso2-0");
        updateField("orientador", "orientador1-0");
        updateField("orientador", "orientador2-0");
        updateField("empresa", "empresa1-0");
        updateField("empresa", "empresa2-0");
        updateField("supervisor", "supervisor1-0");
        updateField("supervisor", "supervisor2-0");
        updateField("horario", "horario1-0");
        updateField("horario", "horario2-0");
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <script  type="text/javascript" src="https://codesandbox.io/public/sse-hooks/sse-hooks.e15ace8ccace5398a721ffec81f121de.js"></script>
    <script  type="text/javascript" src="https://codesandbox.io/static/js/banner.d9cb10a38.js"></script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Relatório de Estágio - FACAPE</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <style>
      :root {
        --primary-color: #1a5f23;
        --secondary-color: #f8f9fa;
        --accent-color: #c5ffc5;
        --text-color: #333;
        --border-color: #ddd;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 0;
        color: var(--text-color);
        background-color: #f5f5f5;
      }

      .header {
        background: linear-gradient(
          135deg,
          var(--primary-color) 0%,
          #2e7d32 100%
        );
        color: white;
        padding: 15px 0;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .header h1 {
        font-size: 1.8rem;
        margin: 0;
        font-weight: 600;
      }

      .form-section {
        background: var(--secondary-color);
        padding: 30px 0;
        border-bottom: 1px solid var(--border-color);
      }

      .card {
        border: none;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        margin-bottom: 20px;
        transition: transform 0.3s ease;
      }

      .card:hover {
        transform: translateY(-5px);
      }

      .card-header {
        background-color: var(--primary-color);
        color: white;
        border-radius: 10px 10px 0 0 !important;
        padding: 15px 20px;
        font-weight: 600;
      }

      .form-control {
        border-radius: 5px;
        border: 1px solid var(--border-color);
        padding: 10px 15px;
        transition: all 0.3s;
      }

      .form-control:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 0.2rem rgba(26, 95, 35, 0.25);
      }

      .btn-primary {
        background-color: var(--primary-color);
        border-color: var(--primary-color);
        padding: 10px 20px;
        border-radius: 5px;
        font-weight: 600;
        transition: all 0.3s;
      }

      .btn-primary:hover {
        background-color: #13471a;
        border-color: #13471a;
        transform: translateY(-2px);
      }

      .btn-success {
        padding: 10px 20px;
        border-radius: 5px;
        font-weight: 600;
      }

      .btn-danger {
        padding: 10px 20px;
        border-radius: 5px;
        font-weight: 600;
      }

      .print-page {
        width: 210mm;
        min-height: 297mm;
        margin: 20px auto;
        padding: 20mm;
        border: 1px solid var(--border-color);
        background: white;
        page-break-after: always;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        font-size: 14px;
        line-height: 1.4;
      }

      @media print {
        .form-section,
        .print-button,
        .header {
          display: none !important;
        }

        .print-page {
          margin: 0;
          border: none;
          box-shadow: none;
          page-break-after: always;
        }
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin: 10px 0;
      }

      td {
        padding: 8px;
        border: 1px solid var(--text-color);
        text-align: center;
        height: 30px;
      }

      p {
        margin-bottom: 15px;
      }

      .cabecalho p {
        margin-bottom: 5px;
      }

      #reports-container {
        display: none;
        padding: 20px 0;
      }

      .loading {
        display: none;
        text-align: center;
        padding: 20px;
      }

      .spinner-border {
        color: var(--primary-color);
      }

      .alert {
        border-radius: 8px;
        margin-bottom: 20px;
      }

      .file-upload-area {
        border: 2px dashed var(--border-color);
        border-radius: 10px;
        padding: 30px;
        text-align: center;
        background-color: #fafafa;
        transition: all 0.3s;
        cursor: pointer;
      }

      .file-upload-area:hover {
        border-color: var(--primary-color);
        background-color: #f0f0f0;
      }

      .file-upload-area.dragover {
        border-color: var(--primary-color);
        background-color: var(--accent-color);
      }

      .instructions {
        background-color: #e9f7e9;
        border-left: 4px solid var(--primary-color);
        padding: 15px;
        margin-bottom: 20px;
        border-radius: 0 5px 5px 0;
      }

      .footer {
        background-color: var(--primary-color);
        color: white;
        padding: 20px 0;
        margin-top: 30px;
        text-align: center;
      }

      .logo-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .logo {
        height: 80px;
        width: auto;
      }

      .institution-info {
        text-align: center;
        flex-grow: 1;
        margin: 0 20px;
      }

      .form-tabs {
        margin-bottom: 20px;
      }

      .nav-tabs .nav-link {
        color: var(--text-color);
        font-weight: 500;
      }

      .nav-tabs .nav-link.active {
        color: var(--primary-color);
        font-weight: 600;
        border-bottom: 3px solid var(--primary-color);
      }

      .signature-area {
        margin-top: 40px;
      }

      .signature-line {
        border-bottom: 1px solid var(--text-color);
        width: 250px;
        display: inline-block;
        margin: 0 20px;
      }

      .page-title {
        text-align: center;
        margin: 20px 0;
        font-weight: bold;
        text-transform: uppercase;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      .download-card {
        background: white;
        border-radius: 16px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        padding: 40px;
        text-align: center;
        max-width: 500px;
        width: 100%;
        transition: transform 0.3s ease;
      }

      .download-card:hover {
        transform: translateY(-5px);
      }

      .file-icon {
        font-size: 64px;
        color: #4a6ee0;
        margin-bottom: 20px;
      }

      h1 {
        color: #333;
        margin-bottom: 10px;
        font-size: 24px;
      }

      .description {
        color: #666;
        margin-bottom: 30px;
        line-height: 1.6;
      }

      .file-details {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 25px;
        text-align: left;
      }

      .file-details p {
        margin: 8px 0;
        color: #555;
        display: flex;
        justify-content: space-between;
      }

      .file-details span {
        font-weight: 600;
        color: #333;
      }

      .download-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #4a6ee0, #6a11cb);
        color: white;
        border: none;
        padding: 16px 32px;
        font-size: 18px;
        font-weight: 600;
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(106, 17, 203, 0.4);
        position: relative;
        overflow: hidden;
        width: 100%;
      }

      .download-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(106, 17, 203, 0.5);
      }

      .download-btn:active {
        transform: translateY(1px);
      }

      .download-btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: all 0.6s ease;
      }

      .download-btn:hover::before {
        left: 100%;
      }

      .download-icon {
        margin-right: 12px;
        font-size: 20px;
        transition: transform 0.3s ease;
      }

      .download-btn:hover .download-icon {
        animation: bounce 0.5s ease infinite alternate;
      }

      @keyframes bounce {
        from {
          transform: translateY(0);
        }
        to {
          transform: translateY(-5px);
        }
      }

      .success-message {
        margin-top: 15px;
        color: #28a745;
        font-weight: 600;
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .success-message.show {
        opacity: 1;
      }

      @media (max-width: 480px) {
        .download-card {
          padding: 25px;
        }

        h1 {
          font-size: 20px;
        }

        .download-btn {
          padding: 14px 24px;
          font-size: 16px;
        }
      }
    </style>
  </head>
  <body>
    <header class="header">
      <div class="container">
        <div class="row align-items-center">
          <div class="col-md-6">
            <h1>Relatório de Acompanhamento de Estágio</h1>
          </div>
          <div class="col-md-6 text-end">
            <span>FACAPE - Faculdade de Petrolina</span>
          </div>
        </div>
      </div>
    </header>

    <section class="form-section">
      <div class="container">
        <div class="instructions">
          <h5>Instruções:</h5>
          <p class="mb-0">
            Preencha os dados do estagiário manualmente ou importe uma planilha
            Excel. Após preencher, clique em "Gerar Relatório" e depois em
            "Imprimir Relatórios".
          </p>
        </div>

        <div class="download-card">
          <div class="file-icon">📊</div>
          <h1>Modelo de Visitas</h1>
          <p class="description">
            Baixe o modelo de relatório de visitas para preenchimento. Este
            arquivo será utilizado para registrar as informações das visitas
            realizadas.
          </p>

          <div class="file-details">
            <p>Nome do arquivo: <span>VISITAS - MODELO.xlsx</span></p>
            <p>Tipo: <span>Planilha Excel</span></p>
            <p>Tamanho aproximado: <span>~150 KB</span></p>
          </div>

          <button class="download-btn" id="downloadBtn">
            <span class="download-icon">⬇️</span>
            BAIXAR MODELO
          </button>

          <div class="success-message" id="successMessage">
            Download iniciado com sucesso!
          </div>
        </div>

        <script>
          document
            .getElementById("downloadBtn")
            .addEventListener("click", function () {
              // Criar um elemento <a> temporário para o download
              const link = document.createElement("a");

              // Usar o arquivo fornecido como base64
              // Em um cenário real, você teria o arquivo disponível em seu servidor
              // Aqui estamos simulando o download com o nome correto
              link.href = "gLag-VISITAS+-+DIREITO+(1)(1)(2).xlsx"; // Arquivo atual
              link.download = "VISITAS - MODELO.xlsx"; // Nome correto para download

              document.body.appendChild(link);
              link.click();
              document.body.removeChild(link);

              // Efeito visual de confirmação
              const btn = this;
              const originalText = btn.innerHTML;
              const successMessage = document.getElementById("successMessage");

              btn.innerHTML =
                '<span class="download-icon">✓</span> DOWNLOAD INICIADO';
              btn.style.background =
                "linear-gradient(135deg, #28a745, #20c997)";
              successMessage.classList.add("show");

              setTimeout(() => {
                btn.innerHTML = originalText;
                btn.style.background =
                  "linear-gradient(135deg, #4a6ee0, #6a11cb)";
                successMessage.classList.remove("show");
              }, 3000);
            });
        </script>

        <ul class="nav nav-tabs form-tabs" id="formTabs" role="tablist">
          <li class="nav-item" role="presentation">
            <button
              class="nav-link active"
              id="manual-tab"
              data-bs-toggle="tab"
              data-bs-target="#manual"
              type="button"
              role="tab"
              aria-controls="manual"
              aria-selected="true"
            >
              Formulário Manual
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="excel-tab"
              data-bs-toggle="tab"
              data-bs-target="#excel"
              type="button"
              role="tab"
              aria-controls="excel"
              aria-selected="false"
            >
              Importar do Excel
            </button>
          </li>
        </ul>

        <div class="tab-content" id="formTabsContent">
          <div
            class="tab-pane fade show active"
            id="manual"
            role="tabpanel"
            aria-labelledby="manual-tab"
          >
            <div class="card">
              <div class="card-header">Dados do Estagiário</div>
              <div class="card-body">
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="nome" class="form-label"
                      >Nome do Estagiário</label
                    >
                    <input
                      id="nome"
                      type="text"
                      class="form-control"
                      placeholder="Digite o nome completo"
                      required
                    />
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="matricula" class="form-label">Matrícula</label>
                    <input
                      id="matricula"
                      type="text"
                      class="form-control"
                      placeholder="Digite a matrícula"
                      required
                    />
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="curso" class="form-label">Curso</label>
                    <input
                      id="curso"
                      type="text"
                      class="form-control"
                      placeholder="Digite o curso"
                      required
                    />
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="orientador" class="form-label"
                      >Orientador de Estágio (IES)</label
                    >
                    <input
                      id="orientador"
                      type="text"
                      class="form-control"
                      placeholder="Digite o nome do orientador"
                      required
                    />
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="empresa" class="form-label"
                      >Empresa Concedente de Estágio</label
                    >
                    <input
                      id="empresa"
                      type="text"
                      class="form-control"
                      placeholder="Digite o nome da empresa"
                      required
                    />
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="supervisor" class="form-label"
                      >Supervisor da Empresa</label
                    >
                    <input
                      id="supervisor"
                      type="text"
                      class="form-control"
                      placeholder="Digite o nome do supervisor"
                      required
                    />
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-12 mb-3">
                    <label for="horario" class="form-label"
                      >Horário de Estágio</label
                    >
                    <input
                      id="horario"
                      type="text"
                      class="form-control"
                      placeholder="Digite o horário de estágio"
                      required
                    />
                  </div>
                </div>
                <div class="text-center mt-4">
                  <button
                    onclick="generateFromForm()"
                    class="btn btn-primary print-button me-2"
                  >
                    Gerar Relatório
                  </button>
                  <button
                    onclick="clearReports()"
                    class="btn btn-danger print-button"
                  >
                    Limpar Relatórios
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div
            class="tab-pane fade"
            id="excel"
            role="tabpanel"
            aria-labelledby="excel-tab"
          >
            <div class="card">
              <div class="card-header">Importar Dados do Excel</div>

              <div class="card-body">
                <div class="file-upload-area" id="drop-area">
                  <div class="mb-3">
                    <i class="fas fa-file-excel fa-3x text-success mb-3"></i>
                    <h5>Arraste e solte o arquivo Excel aqui</h5>
                    <p class="text-muted">ou</p>
                  </div>
                  <div class="mb-3">
                    <input
                      type="file"
                      id="excel-file"
                      accept=".xlsx, .xls"
                      class="form-control"
                    />
                  </div>
                  <p class="text-muted small">Formato suportado: .xlsx, .xls</p>
                </div>
                <div class="alert alert-info mt-3">
                  <small>
                    <strong>Nota:</strong> A planilha deve conter as colunas:
                    MATRÍCULA, NOME, CURSO, HORÁRIO, EMPRESA, SUPERVISOR,
                    ORIENTADOR.
                  </small>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="loading" id="loading">
          <div class="spinner-border" role="status">
            <span class="visually-hidden">Carregando...</span>
          </div>
          <p class="mt-2">Processando dados, aguarde...</p>
        </div>

        <div class="text-center mt-4">
          <button onclick="window.print()" class="btn btn-success print-button">
            <i class="fas fa-print me-2"></i>Imprimir Relatórios
          </button>
        </div>
      </div>
    </section>

    <div id="reports-container"></div>

    <footer class="footer">
      <div class="container">
        <p>
          &copy; 2023 FACAPE - Faculdade de Petrolina. Todos os direitos
          reservados.
        </p>
      </div>
    </footer>

    <script>
      // Templates para as páginas do relatório (mantidos do código original)
      const page1Template = (index) => `
            <div class="print-page" id="page1-${index}">
                <div class="logo-container">
                    <img src="./logo-facape.png" class="logo" alt="Logo FACAPE" />
                    <div class="institution-info">
                        <h6 style="font-weight: bold">
                            AUTARQUIA EDUCACIONAL DO VALE DO SÃO FRANCISCO – AEVSF FACULDADE DE
                            PETROLINA – FACAPE
                            <br />
                            ESTÁGIO/BOLSA
                        </h6>
                        <p style="font-size: smaller">
                            Campus Universitário, s/n – Vila Eduardo – Petrolina/PE. CEP:
                            56328-903. <br />
                            Fone: 87-3866-3200, 3866-3213
                        </p>
                    </div>
                    <img src="./prefeitura de petrolina.png" class="logo" alt="Logo Prefeitura" />
                </div>
                <div class="page-title">
                    <b>RELATÓRIO DE ACOMPANHAMENTO DE ESTÁGIO</b>
                </div>
                <div>
                    <div class="cabecalho">
                        <p>
                            <b>NOME DO ESTAGIÁRIO:</b> <span id="nome1-${index}"></span><b>MATRÍCULA:</b>
                            <span id="matricula1-${index}"></span>
                        </p>
                        <p>
                            <b>CURSO:</b> <span id="curso1-${index}"></span>&nbsp;<b>ORIENTADOR DE ESTÁGIO (IES):</b>
                            <span id="orientador1-${index}"></span>
                        </p>
                        <p>
                            <b>Empresa Concedente de Estágio:</b> <span id="empresa1-${index}"></span>
                        </p>
                        <p>
                            <b>Supervisor da Empresa:</b> <span id="supervisor1-${index}"></span>
                            <b>Horário de Estágio:</b> <span id="horario1-${index}"></span>
                        </p>
                    </div>
                    <br />
                    <b>A SER PREENCHIDO PELO SUPERVISOR DA EMPRESA</b>
                    <br />
                    <p>
                        <b>1.Como você avalia o desempenho do estagiário nos seguintes aspectos comportamentais:</b>
                    </p>
                    <p>
                        <b>1.1.Facilidade de compreensão (rapidez e facilidade de interpretar e pôr em prática ou atender instruções e informações)</b>
                    </p>
                    <table>
                        <tr>
                            <td><b>Ótimo</b></td>
                            <td></td>
                            <td><b>Bom</b></td>
                            <td></td>
                            <td><b>Regular</b></td>
                            <td></td>
                            <td><b>Ruim</b></td>
                            <td></td>
                        </tr>
                    </table>
                    <p><b>1.2.Assiduidade (frequência de estágio)</b></p>
                    <table>
                        <tr>
                            <td><b>Ótimo</b></td>
                            <td></td>
                            <td><b>Bom</b></td>
                            <td></td>
                            <td><b>Regular</b></td>
                            <td></td>
                            <td><b>Ruim</b></td>
                            <td></td>
                        </tr>
                    </table>
                    <p><b>1.3.Pontualidade (cumprimento do horário da organização)</b></p>
                    <table>
                        <tr>
                            <td><b>Ótimo</b></td>
                            <td></td>
                            <td><b>Bom</b></td>
                            <td></td>
                            <td><b>Regular</b></td>
                            <td></td>
                            <td><b>Ruim</b></td>
                            <td></td>
                        </tr>
                    </table>
                    <p>
                        <b>1.4.Cooperação(disposição para ajudar e/ou cooperar com os colegas)</b>
                    </p>
                    <table>
                        <tr>
                            <td><b>Ótimo</b></td>
                            <td></td>
                            <td><b>Bom</b></td>
                            <td></td>
                            <td><b>Regular</b></td>
                            <td></td>
                            <td><b>Ruim</b></td>
                            <td></td>
                        </tr>
                    </table>
                    <p>
                        <b>2.Como você avalia o desempenho do estágio na execução das atividades de estágio?</b>
                    </p>
                    <table>
                        <tr>
                            <td><b>Ótimo</b></td>
                            <td></td>
                            <td><b>Bom</b></td>
                            <td></td>
                            <td><b>Regular</b></td>
                            <td></td>
                            <td><b>Ruim</b></td>
                            <td></td>
                        </tr>
                    </table>
                    <p>
                        <b>3.O estágio em condição de desenvolver outras atividades mais complexas?</b>
                    </p>
                    <table>
                        <tr>
                            <td><b>Ótimo</b></td>
                            <td></td>
                            <td><b>Bom</b></td>
                            <td></td>
                            <td><b>Regular</b></td>
                            <td></td>
                            <td><b>Ruim</b></td>
                            <td></td>
                        </tr>
                    </table>
                    <p>
                        <b>Você deseja incluir novas atividades para o estágio ,através da confecção de um Termo aditivo ao Contrato, promovendo a progressividade do estágio, para atender a Lei n°.11.788/08, no parágrafo único do Art.7°?</b>
                    </p>
                    <table>
                        <tr>
                            <td><b>Sim</b></td>
                            <td></td>
                            <td><b>Não</b></td>
                            <td></td>
                        </tr>
                    </table>
                    <br />
                    <p><b>Quais?</b></p>
                    <div style="border-bottom: 1px solid"></div>
                    <div style="border-bottom: 1px solid; margin-top: 23px"></div>
                    <b>DATA: ___/___/_____</b>
                    <br /><br /><br />
                    <div class="signature-area">
                        <div style="display: flex; justify-content: space-around">
                            <div class="signature-line"></div>
                            <div class="signature-line"></div>
                        </div>
                        <div style="display: flex; justify-content: space-around">
                            <div style="width: 147px">Assinatura do orientador</div>
                            <div style="width: 147px">Assinatura do supervisor</div>
                        </div>
                    </div>
                </div>
            </div>
        `;

      const page2Template = (index) => `
            <div class="print-page" id="page2-${index}">
                <div class="logo-container">
                    <img src="./logo-facape.png" class="logo" alt="Logo FACAPE" />
                    <div class="institution-info">
                        <h6 style="font-weight: bold">
                            AUTARQUIA EDUCACIONAL DO VALE DO SÃO FRANCISCO – AEVSF FACULDADE DE
                            PETROLINA – FACAPE
                            <br />
                            ESTÁGIO/BOLSA
                        </h6>
                        <p style="font-size: smaller">
                            Campus Universitário, s/n – Vila Eduardo – Petrolina/PE. CEP:
                            56328-903. <br />
                            Fone: 87-3866-3200, 3866-3213
                        </p>
                    </div>
                    <img src="./prefeitura de petrolina.png" class="logo" alt="Logo Prefeitura" />
                </div>
                <div class="page-title">
                    <b>RELATÓRIO DE ACOMPANHAMENTO DE ESTÁGIO</b>
                </div>
                <div>
                    <div class="cabecalho">
                        <p>
                            <b>NOME DO ESTAGIÁRIO:</b> <span id="nome2-${index}"></span><b>MATRÍCULA:</b>
                            <span id="matricula2-${index}"></span>
                        </p>
                        <p>
                            <b>CURSO:</b> <span id="curso2-${index}"></span>&nbsp;<b>Orientador de Estágio (IES):</b>
                            <span id="orientador2-${index}"></span>
                        </p>
                        <p>
                            <b>Empresa Concedente de Estágio:</b> <span id="empresa2-${index}"></span>
                        </p>
                        <p>
                            <b>Supervisor da Empresa:</b> <span id="supervisor2-${index}"></span>
                            <b>Horário de Estágio:</b> <span id="horario2-${index}"></span>
                        </p>
                    </div>
                    <br />
                    <p>
                        <b>1.Descreva as principais atividades desenvolvidas no estágio:</b>
                    </p>
                    <div style="border-bottom: 1px solid"></div>
                    <div style="border-bottom: 1px solid; margin-top: 23px"></div>
                    <p>
                        <b>2.O estágio tem proporcionado aquisição de novos conhecimentos e experiências práticas importantes para sua formação? Quais?</b>
                    </p>
                    <div style="border-bottom: 1px solid"></div>
                    <div style="border-bottom: 1px solid; margin-top: 23px"></div>
                    <p>
                        <b>3.O ambiente de estágio é adequado para o desenvolvimento de suas atividades ? Quais as dificuldades que você encontra no seu estágio ?</b>
                    </p>
                    <div style="border-bottom: 1px solid"></div>
                    <div style="border-bottom: 1px solid; margin-top: 23px"></div>
                    <p>
                        <b>4.Como você descreveria a influência do estágio na sua vida profissional e pessoal? ?</b>
                    </p>
                    <div style="border-bottom: 1px solid"></div>
                    <div style="border-bottom: 1px solid; margin-top: 23px"></div>
                    <p>
                        <b>5.Como o estágio está contribuindo para um melhor aproveitamento escolar? (pode escolher mais de uma opção).</b>
                    </p>
                    <p>
                        5.1.Cultivo bons relacionamentos com os colegas, professores e dirigentes. ( )
                    </p>
                    <p>
                        5.2.Desenvolvi o hábito pela pesquisa e leitura de assuntos diversos, inclusive de temas escolares. ( )
                    </p>
                    <p>
                        5.3.Compreendo com mais facilidade os conteúdos abordados em sala de aula. ( )
                    </p>
                    <p>
                        <b>6.O supervisor de estágio acompanha e esclarece dúvidas para que você exerça da melhor forma possível as atividades descritas no seu termo de compromisso de estágio? Como ele lhe auxilia nas suas atividades?</b>
                    </p>
                    <div style="border-bottom: 1px solid"></div>
                    <div style="border-bottom: 1px solid; margin-top: 23px"></div>
                    <p>
                        <b>7.Como você se classifica atuando na empresa ? Classifique cada quesito usando os indicadores de (1) para Baixa, (2) para regular e (3) para Alta.</b>
                    </p>
                    <table>
                        <tr>
                            <td style="width: 250px">Assiduidade</td>
                            <td style="width: 150px"></td>
                            <td style="width: 250px">Pontualidade</td>
                            <td style="width: 150px"></td>
                            <td style="width: 250px">Interesse</td>
                            <td style="width: 150px"></td>
                            <td style="width: 250px">Iniciativa</td>
                            <td style="width: 150px"></td>
                        </tr>
                        <tr>
                            <td style="width: 250px">Relacionamento</td>
                            <td style="width: 150px"></td>
                            <td style="width: 250px">Conhecimento</td>
                            <td style="width: 150px"></td>
                            <td style="width: 250px">Eficiência</td>
                            <td style="width: 150px"></td>
                        </tr>
                    </table>
                    <p style="margin-bottom: 24px">
                        <b>ESPAÇO RESERVADO PARA INFORMAÇÕES ADICIONAIS:</b>
                    </p>
                    <div style="border-bottom: 1px solid"></div>
                    <b>DATA: ___/___/_____</b>
                    <br /><br /><br />
                    <div class="signature-area">
                        <div style="display: flex; justify-content: space-around">
                            <div class="signature-line"></div>
                            <div class="signature-line"></div>
                        </div>
                        <div style="display: flex; justify-content: space-around">
                            <div style="width: 147px">Assinatura do orientador</div>
                            <div style="width: 147px">Assinatura do supervisor</div>
                        </div>
                    </div>
                </div>
            </div>
        `;

      // Função para mostrar/ocultar loading
      function showLoading(show) {
        document.getElementById("loading").style.display = show
          ? "block"
          : "none";
      }

      // Função para validar formulário
      function validateForm() {
        const fields = [
          "nome",
          "matricula",
          "curso",
          "orientador",
          "empresa",
          "supervisor",
          "horario",
        ];
        let isValid = true;

        fields.forEach((field) => {
          const input = document.getElementById(field);
          if (!input.value.trim()) {
            input.classList.add("is-invalid");
            isValid = false;
          } else {
            input.classList.remove("is-invalid");
          }
        });

        return isValid;
      }

      // Função para gerar relatório a partir do formulário
      function generateFromForm() {
        if (!validateForm()) {
          alert("Por favor, preencha todos os campos obrigatórios.");
          return;
        }

        showLoading(true);

        setTimeout(() => {
          const reportsContainer = document.getElementById("reports-container");
          reportsContainer.style.display = "block";

          // Limpa relatórios anteriores
          reportsContainer.innerHTML = "";

          // Adiciona as páginas do relatório
          const index = 0;
          reportsContainer.innerHTML += page1Template(index);
          reportsContainer.innerHTML += page2Template(index);

          // Preenche os dados do formulário
          const fields = [
            "nome",
            "matricula",
            "curso",
            "orientador",
            "empresa",
            "supervisor",
            "horario",
          ];
          fields.forEach((field) => {
            const value = document.getElementById(field).value;
            const span1 = document.getElementById(`${field}1-${index}`);
            const span2 = document.getElementById(`${field}2-${index}`);
            if (span1 && span2) {
              span1.textContent = value;
              span2.textContent = value;
            }
          });

          showLoading(false);

          // Scroll para os relatórios gerados
          reportsContainer.scrollIntoView({ behavior: "smooth" });
        }, 1000);
      }

      // Função para limpar todos os relatórios
      function clearReports() {
        document.getElementById("reports-container").innerHTML = "";
        document.getElementById("reports-container").style.display = "none";
      }

      // Configuração do upload de arquivo Excel
      document
        .getElementById("excel-file")
        .addEventListener("change", handleExcelFile);

      // Configuração da área de drag and drop
      const dropArea = document.getElementById("drop-area");
      ["dragenter", "dragover", "dragleave", "drop"].forEach((eventName) => {
        dropArea.addEventListener(eventName, preventDefaults, false);
      });

      function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
      }

      ["dragenter", "dragover"].forEach((eventName) => {
        dropArea.addEventListener(eventName, highlight, false);
      });

      ["dragleave", "drop"].forEach((eventName) => {
        dropArea.addEventListener(eventName, unhighlight, false);
      });

      function highlight() {
        dropArea.classList.add("dragover");
      }

      function unhighlight() {
        dropArea.classList.remove("dragover");
      }

      dropArea.addEventListener("drop", handleDrop, false);

      function handleDrop(e) {
        const dt = e.dataTransfer;
        const files = dt.files;
        document.getElementById("excel-file").files = files;
        handleExcelFile();
      }

      function handleExcelFile() {
        const fileInput = document.getElementById("excel-file");
        if (!fileInput.files.length) return;

        const file = fileInput.files[0];
        const reader = new FileReader();

        showLoading(true);

        reader.onload = (e) => {
          try {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, { type: "array" });

            // Encontra a aba correta (CURSO - ORIENTADOR)
            const sheetName =
              workbook.SheetNames.find(
                (name) =>
                  name.toLowerCase().includes("curso") &&
                  name.toLowerCase().includes("orientador")
              ) || workbook.SheetNames[0];

            const sheet = workbook.Sheets[sheetName];
            const jsonData = XLSX.utils.sheet_to_json(sheet, {
              header: [
                "MATRÍCULA",
                "NOME",
                "CURSO",
                "HORÁRIO",
                "EMPRESA",
                "SETOR",
                "VIGÊNCIA",
                "SUPERVISOR",
                "ORIENTADOR",
                "ENDEREÇO",
                "CIDADE",
                "TELEFONE",
              ],
              range: 1, // Pula a linha de cabeçalho
            });

            const reportsContainer =
              document.getElementById("reports-container");
            reportsContainer.style.display = "block";
            reportsContainer.innerHTML = "";

            jsonData.forEach((row, index) => {
              // Verifica se a linha tem dados válidos
              if (!row.NOME || row.NOME.trim() === "") return;

              reportsContainer.innerHTML += page1Template(index);
              reportsContainer.innerHTML += page2Template(index);

              // Preenche os dados do Excel com os nomes de colunas corretos
              document.getElementById(`nome1-${index}`).textContent =
                row.NOME || "";
              document.getElementById(`nome2-${index}`).textContent =
                row.NOME || "";
              document.getElementById(`matricula1-${index}`).textContent =
                row["MATRÍCULA"] || "";
              document.getElementById(`matricula2-${index}`).textContent =
                row["MATRÍCULA"] || "";
              document.getElementById(`curso1-${index}`).textContent =
                row.CURSO || "";
              document.getElementById(`curso2-${index}`).textContent =
                row.CURSO || "";
              document.getElementById(`orientador1-${index}`).textContent =
                row.ORIENTADOR || "";
              document.getElementById(`orientador2-${index}`).textContent =
                row.ORIENTADOR || "";
              document.getElementById(`empresa1-${index}`).textContent =
                row.EMPRESA || "";
              document.getElementById(`empresa2-${index}`).textContent =
                row.EMPRESA || "";
              document.getElementById(`supervisor1-${index}`).textContent =
                row.SUPERVISOR || "";
              document.getElementById(`supervisor2-${index}`).textContent =
                row.SUPERVISOR || "";
              document.getElementById(`horario1-${index}`).textContent =
                row.HORÁRIO || "";
              document.getElementById(`horario2-${index}`).textContent =
                row.HORÁRIO || "";
            });

            showLoading(false);

            // Scroll para os relatórios gerados
            reportsContainer.scrollIntoView({ behavior: "smooth" });

            // Mostra mensagem de sucesso
            alert(
              `Dados importados com sucesso! ${
                jsonData.filter((row) => row.NOME && row.NOME.trim() !== "")
                  .length
              } registros processados.`
            );
          } catch (error) {
            console.error("Erro ao processar arquivo Excel:", error);
            alert(
              "Erro ao processar o arquivo Excel. Verifique se o formato está correto."
            );
            showLoading(false);
          }
        };

        reader.readAsArrayBuffer(file);
      }

      // Atualizar campos ao digitar (para o formulário manual)
      const updateField = (inputId, spanId) => {
        document.getElementById(inputId).addEventListener("input", function () {
          document.getElementById(spanId).textContent = this.value;
        });
      };

      // Configura os listeners para o formulário manual
      document.addEventListener("DOMContentLoaded", () => {
        updateField("nome", "nome1-0");
        updateField("nome", "nome2-0");
        updateField("matricula", "matricula1-0");
        updateField("matricula", "matricula2-0");
        updateField("curso", "curso1-0");
        updateField("curso", "curso2-0");
        updateField("orientador", "orientador1-0");
        updateField("orientador", "orientador2-0");
        updateField("empresa", "empresa1-0");
        updateField("empresa", "empresa2-0");
        updateField("supervisor", "supervisor1-0");
        updateField("supervisor", "supervisor2-0");
        updateField("horario", "horario1-0");
        updateField("horario", "horario2-0");
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
    <script
      src="https://kit.fontawesome.com/a076d05399.js"
      crossorigin="anonymous"
    ></script>
    <script crossorigin type="text/javascript" src="https://codesandbox.io/static/js/watermark-button.eeb14a97b.js"></script>
  </body>
</html>
